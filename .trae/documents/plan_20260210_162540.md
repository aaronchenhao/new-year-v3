# HTTPS环境下认证失败问题解决方案

## 问题分析

用户将网站域名从HTTP切换到HTTPS后，访问后端服务接口报401 Unauthorized错误，具体表现为：
- `GET https://backend.cyberworld.site/admin/stats 401 (Unauthorized)`
- `GET https://backend.cyberworld.site/admin/users/visits 401 (Unauthorized)`

## 可能原因

1. **CORS配置问题**：后端的CORS配置可能没有正确处理HTTPS环境下的跨域请求
2. **认证头传递问题**：HTTPS环境下，浏览器可能不会自动传递认证头
3. **环境变量问题**：后端可能使用了环境变量中的ADMIN_PASSWORD，如果环境变量没有正确设置，会导致认证失败
4. **相对路径问题**：前端使用相对路径进行API调用，可能在HTTPS环境下解析不正确

## 解决方案

### 1. 修改后端CORS配置

- 更新`admin/server/index.js`中的CORS配置，明确指定允许的源和头部
- 确保CORS配置允许`Authorization`头部传递
- 配置支持HTTPS域名的跨域请求

### 2. 验证前端认证头设置

- 检查`dashboard.html`中的`getAuthHeaders`函数，确保正确设置认证头
- 验证认证头在HTTPS环境下是否正确传递

### 3. 检查环境变量配置

- 确保后端服务的环境变量中设置了正确的ADMIN_PASSWORD
- 如果没有设置，使用默认值'admin123'

### 4. 测试和验证

- 测试HTTPS环境下的API调用，确保认证头正确传递
- 验证后端服务是否正确接收和验证认证头
- 测试各种API端点，确保都能正常访问

## 预期效果

- HTTPS环境下的API调用不再报401 Unauthorized错误
- 前端能够正常访问后端的所有API端点
- 认证机制在HTTPS环境下正常工作
- 跨域请求在HTTPS环境下正常处理