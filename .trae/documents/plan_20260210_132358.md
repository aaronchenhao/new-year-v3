# 前端服务端配置分析与优化计划

## 现状分析

### 1. 管理端前端配置 (`admin/client/js/api.js`)

* **当前配置**：使用相对路径 `/admin` 作为API基础URL

* **优点**：不需要硬编码IP或域名，部署更灵活

* **原理**：依赖于前端和后端部署在同一个域名下，通过路径前缀区分

### 2. 用户端前端配置 (`App.tsx`)

* **当前配置**：使用硬编码的 `http://horse-universe-backend:3001` 作为API基础URL

* **问题**：这是Docker内部服务名称，生产部署中需要修改

* **影响**：部署到腾讯云1Panel时需要更新为实际服务器IP或域名

## 优化方案

### 1. 管理端前端（保持现状）

* **理由**：相对路径配置更灵活，适合生产部署

* **部署建议**：通过Nginx反向代理将 `/admin` 路径转发到管理端后端服务

### 2. 用户端前端（需要修改）

* **方案A**：使用相对路径配置

  * 修改 `App.tsx` 中的API调用，使用相对路径 `/api/...`

  * 通过Nginx反向代理将 `/api` 路径转发到用户服务端

  * **优点**：部署灵活，不需要修改代码

* **方案B**：使用环境变量配置

  * 创建配置文件存储API基础URL

  * 通过环境变量或配置文件管理不同环境的API地址

  * **优点**：便于管理多环境配置

### 3. Nginx配置优化

* **前端网站**：配置反向代理

  * `/api` → `http://localhost:3001`

  * `/admin` → `http://localhost:3002`

* **SSL配置**：启用HTTPS

* **性能优化**：配置缓存和压缩

## 部署步骤

### 1. 修改用户端前端API配置

* 选择合适的方案（相对路径或环境变量）

* 更新 `App.tsx` 中的API调用代码

### 2. 配置Nginx反向代理

* 在1Panel中编辑前端网站的Nginx配置

* 添加反向代理规则

* 测试API调用是否正常

### 3. 验证部署

* 测试前端功能

* 测试API调用

* 确保管理端和用户端都能正常工作

## 技术要点

* **相对路径配置**：适合单域名部署，简化配置

* **Nginx反向代理**：实现路径转发，隐藏后端服务端口

* **环境变量管理**：便于多环境部署和配置管理

* **SSL证书**：确保数据传输安全

## 预期结果

* 前端网站正常访问

* API调用通过相对路径或配置文件正确路由

* 部署过程简化，减少硬编码配置

